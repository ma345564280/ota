<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ota.dao.AdvertisementMapper">
	<resultMap id="BaseResultMap" type="com.ota.domain.Advertisement">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<id column="id" property="id" jdbcType="INTEGER" />
		<result column="adversion" property="adversion" jdbcType="VARCHAR" />
		<result column="update_time" property="updateTime" jdbcType="TIMESTAMP" />
		<result column="download" property="download" jdbcType="VARCHAR" />
		<result column="positionID" property="positionid" jdbcType="INTEGER" />
		<result column="gotoUrl" property="gotourl" jdbcType="VARCHAR" />
		<result column="mappingid" property="mappingid" jdbcType="VARCHAR" />
		<result column="businessid" property="businessid" jdbcType="VARCHAR" />
	</resultMap>
	<sql id="Base_Column_List">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		id, adversion, update_time, download, positionID, gotoUrl, mappingid,
		businessid
	</sql>


	<!-- 自定义sql -->
	<select id="selectAllAdvertisementWithFilter" parameterType="Map" resultType="AdverInfo">
		select 
			ad.id,
			ad.download, 
			bs.name, 
			ad.adversion,
			ad.positionid,
			ad.gotourl,
			ad.enforce,
			ad.update_time updateTime,
			ad.status,
			ad.mappingid,
			og.groupname
		from 
			advertisement ad 
		LEFT JOIN
			business bs ON ad.businessid = bs.id
		LEFT JOIN
			otagroup og on og.id = ad.groupid
		<where>
	        <if test="customerid!=null">
	            businessid=#{customerid,jdbcType=INTEGER}
	        </if>
	    </where>
	    order by ad.update_time	
	</select>
	<select id="selectForRoot" resultMap="BaseResultMap">
	    select
		<include refid="Base_Column_List" />
		from advertisement 
		order by update_time desc
	</select>
	
	<select id="selectByAdversion" resultType="java.lang.String"
		parameterType="java.lang.String">
		select mappingid from advertisement where
		adversion=#{adversion,jdbcType=VARCHAR}
	</select>

	<select id="selectAdvertisementInfo" resultType="com.ota.domain.AdvertisementInfo"
		parameterType="com.ota.domain.AdvertisementInfo">
		select * from advertisement inner join
		advertisementmapping on
		(advertisement.mappingid like
		CONCAT('',advertisementmapping.id,'')
		OR advertisement.mappingid like
		CONCAT('%,',advertisementmapping.id,',%')
		OR advertisement.mappingid
		like CONCAT('',advertisementmapping.id,',%')
		OR advertisement.mappingid
		like
		CONCAT('%,',advertisementmapping.id,''))
		and type =
		#{Type,jdbcType=VARCHAR} and
		romversion=#{RomVersion,jdbcType=VARCHAR}
		

	</select>
	<select id="selectByBusinessId" resultMap="BaseResultMap"
		parameterType="java.lang.String">
		select
		<include refid="Base_Column_List" />
		from advertisement
		where businessid = #{businessid,jdbcType=VARCHAR} 
		order by update_time
		DESC
	</select>

	<update id="updateMappingIDByPrimaryKey" parameterType="Advertisement">
		update
		advertisement set mappingid=#{mappingid} where id=#{id}
	</update>


	<select id="selectlastid" resultType="int">
		select max(id) from
		advertisement;
	</select>





	<select id="selectByPrimaryKey" resultMap="BaseResultMap"
		parameterType="java.lang.Integer">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select
		<include refid="Base_Column_List" />
		from advertisement
		where id = #{id,jdbcType=INTEGER}
	</select>
	<delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		delete from advertisement
		where id = #{id,jdbcType=INTEGER}
	</delete>
	<insert id="insert" parameterType="com.ota.domain.Advertisement">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into advertisement (id, adversion, update_time,
		download,
		positionID, gotoUrl,
		mappingid, businessid)
		values
		(#{id,jdbcType=INTEGER}, #{adversion,jdbcType=VARCHAR},
		#{updateTime,jdbcType=TIMESTAMP},
		#{download,jdbcType=VARCHAR},
		#{positionid,jdbcType=INTEGER}, #{gotourl,jdbcType=VARCHAR},
		#{mappingid,jdbcType=VARCHAR}, #{businessid,jdbcType=VARCHAR})
	</insert>
	<insert id="insertSelective" parameterType="com.ota.domain.Advertisement">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into advertisement
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="id != null">
				id,
			</if>
			<if test="adversion != null">
				adversion,
			</if>
			<if test="updateTime != null">
				update_time,
			</if>
			<if test="download != null">
				download,
			</if>
			<if test="positionid != null">
				positionID,
			</if>
			<if test="gotourl != null">
				gotoUrl,
			</if>
			<if test="mappingid != null">
				mappingid,
			</if>
			<if test="businessid != null">
				businessid,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="id != null">
				#{id,jdbcType=INTEGER},
			</if>
			<if test="adversion != null">
				#{adversion,jdbcType=VARCHAR},
			</if>
			<if test="updateTime != null">
				#{updateTime,jdbcType=TIMESTAMP},
			</if>
			<if test="download != null">
				#{download,jdbcType=VARCHAR},
			</if>
			<if test="positionid != null">
				#{positionid,jdbcType=INTEGER},
			</if>
			<if test="gotourl != null">
				#{gotourl,jdbcType=VARCHAR},
			</if>
			<if test="mappingid != null">
				#{mappingid,jdbcType=VARCHAR},
			</if>
			<if test="businessid != null">
				#{businessid,jdbcType=VARCHAR},
			</if>
		</trim>
	</insert>
	
	
	<update id="updateForAddFilterToMultFile" parameterType="Advertisement">
	    update advertisement set 
		mappingid = #{mappingid,jdbcType=VARCHAR}
		where id = #{id,jdbcType=INTEGER}
	</update>
	<update id="updateByPrimaryKeySelective" parameterType="com.ota.domain.Advertisement">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		update advertisement
		<set>
			<if test="adversion != null">
				adversion = #{adversion,jdbcType=VARCHAR},
			</if>
			<if test="updateTime != null">
				update_time = #{updateTime,jdbcType=TIMESTAMP},
			</if>
			<if test="download != null">
				download = #{download,jdbcType=VARCHAR},
			</if>
			<if test="positionid != null">
				positionID = #{positionid,jdbcType=INTEGER},
			</if>
			<if test="gotourl != null">
				gotoUrl = #{gotourl,jdbcType=VARCHAR},
			</if>
			<if test="mappingid != null">
				mappingid = #{mappingid,jdbcType=VARCHAR},
			</if>
			<if test="businessid != null">
				businessid = #{businessid,jdbcType=VARCHAR},
			</if>
		</set>
		where id = #{id,jdbcType=INTEGER}
	</update>
	<update id="updateByPrimaryKey" parameterType="com.ota.domain.Advertisement">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		update advertisement
		set adversion = #{adversion,jdbcType=VARCHAR},
		update_time = #{updateTime,jdbcType=TIMESTAMP},
		download =
		#{download,jdbcType=VARCHAR},
		positionID =
		#{positionid,jdbcType=INTEGER},
		gotoUrl = #{gotourl,jdbcType=VARCHAR},
		mappingid = #{mappingid,jdbcType=VARCHAR},
		businessid =
		#{businessid,jdbcType=VARCHAR}
		where id = #{id,jdbcType=INTEGER}
	</update>
</mapper>